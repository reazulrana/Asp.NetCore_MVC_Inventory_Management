@*@model List<ProductListViewModel>*@
@model PaginatedList<ProductListViewModel>
@{
    ViewBag.Title = "Product List";

    //bool haspreviousPage=Model.Has
}


<div class="card">
    <div class="card-header">
        <h3 class="card-title text-white">Product List</h3>
    </div>
    <div class="card-body">
        <div class="row py-4">
            <div class="col-sm-3">
                <select class="form-control" name="_pagesize">
                    <option value="10"><a asp-controller="Product" asp-action="ProductList" asp-route-_pagesize="10"></a>10</option>
                </select>
            </div>
            <div class="col-sm-9 float-right">
                <div class="input-group pull-right">
                    <input placeholder="Search" class="form-control col-sm-3" />
                    <button class="btn btn-facebook"><span><i class="la la-search"></i></span></button>
                </div>
            </div>
        </div>

        

        <table class="table table-responsive table-bordered table-striped" id="productList">
            <thead>
                <tr>
                    <th>SL</th>
                    <th>Image</th>
                    <th>Code</th>
                    <th>Description</th>
                    <th>Model</th>
                    <th>Size</th>
                    <th>Color</th>
                    <th>Unit Price</th>
                    <th>Action</th>


                    @*<th>SizeName</th>
                    <th>SizeType</th>
                    <th>Unitprice</th>
                    <th>OpeningBalance</th>*@
                </tr>
            </thead>
            <tbody>
            </tbody>
            @if (Model != null && Model.Count > 0)
            {
                int sl = ((Model.PageIndex - 1) * Model.PageSize) == 0 ? 1 : ((Model.PageIndex - 1) * Model.PageSize) + 1;

                foreach (var _model in Model)
                {
                    string photopath = @_model.PhotoPath != null ? "~/" + ImagePath.GetProductImagePath(_model.PhotoPath) : ImagePath.GetBlankImageFromRootFolder();
                    // string url = @_model.PhotoPath != null ? ImagePath.GetProductImagePath(_model.PhotoPath) : ImagePath.GetBlankImageFromRootFolder();
                    <tr>
                        <td>@sl</td>
                        <td>

                            <img class="rounded" src="@photopath" asp-append-version="true" width="90" height="90" alt="No-Image" />

                        </td>
                        <td>@_model.Code</td>
                        <td>@_model.Description</td>
                        <td>@_model.ModelName</td>
                        <td>@_model.SizeName</td>
                        <td>@_model.Color</td>
                        <td>@_model.Unitprice</td>
                        <td>
                            <div class="row">
                                <div class="col-md-6">
                                    <button class="btn btn-outline-secondary btn-xs">Edit<span class="btn-icon-right"><i class="mdi mdi-pencil"></i></span></button>
                                    <button class="btn btn-outline-danger btn-xs">Delete<span class="btn-icon-right"><i class="mdi mdi-delete"></i></span></button>
                                </div>
                            </div>

                        </td>


                    </tr>
                    sl = sl + 1;
                }

            }
        </table>

        @*Pagination Bar*@

        @{
            int PreviousPage = (Model.PageIndex - 1) <= 0 ? 1 : Model.PageIndex - 1;
            int NextPage = (Model.PageIndex + 1) >= Model.TotalPage ? Model.TotalPage : Model.PageIndex + 1;

            int pagestart = 1;
            int pageEnd = Model.TotalPage;


        }
        <nav>
            <ul class="pagination pagination-sm pagination-danger">
                <li class="page-item page-indicator">
                    <a class="page-link" asp-controller="Product" asp-action="ProductList" asp-route-pagenumber="@pagestart">
                        @*<i class="fa fa-arrow-left"></i>*@
                        <i class="la la-angle-double-left"></i>
                    </a>
                </li>

                <li class="page-item page-indicator">
                    <a class="page-link" asp-controller="Product" asp-action="ProductList" asp-route-pagenumber="@PreviousPage">
                        <i class="la la-angle-left"></i>
                    </a>
                </li>
                @for (int i = 1; i <= Model.TotalPage; i++)
                {
                    <li class="page-item">
                        <a class="page-link" asp-controller="Product" asp-action="ProductList" asp-route-pagenumber="@i">@i</a>
                    </li>
                }
                <li class="page-item page-indicator">
                    <a class="page-link" asp-controller="Product" asp-action="ProductList" asp-route-pagenumber="@NextPage">
                        <i class="la la-angle-right"></i>
                    </a>
                </li>
                <li class="page-item page-indicator">
                    <a class="page-link" asp-controller="Product" asp-action="ProductList" asp-route-pagenumber="@pageEnd">
                        @*<i class="fa fa-arrow-left"></i>*@
                        <i class="la la-angle-double-right"></i>
                    </a>
                </li>
            </ul>
        </nav>


    </div>
    <div class="card-footer">

    </div>
</div>


@section Scripts{
    <script>
        $(document).ready(function () {



            function loadDataTable() {

                @*new DataTable("#productList", {
                    ajax: '@Url.Action("LoadDataTable", "Product")',
                    columns: [

                        { data: 'Code' },
                        { data: 'Description' },
                        { data: 'Category' },
                        { data: 'BrandName' },
                        { data: 'ModelName' },
                        { data: 'Color' }]
                });*@


                //var datas = [
                //    code: "Rana",

                //]

                @*$.ajax({
                    url: '@Url.Action("LoadDataTable", "Product")',
                    method: "GET",
                    dataType: "JSON",
                    success: function (data) {

                        console.log(data)
                        $("#productList").DataTable({
                            data: data.dataTables,
                            columns: [
                                //{
                                //    'data': 'photoPath',
                                //    //'render': function (photoPath) {
                                //    //    var path = photoPath!=null ? "/Projects/Images/Product/" + photoPath :null
                                //    //    var img = '<img src="' + path + '" height="100px" width="100px" />'
                                //    //    return img;
                                //    //}
                                //},
                                { 'data': 'code' },
                                { 'data': 'description' },
                                { 'data': 'category' },
                                { 'data': 'sizeName' },
                                { 'data': 'color' },
                                { 'data': 'unitprice' },
                                {
                                    'data': 'id',
                                    'render': function (id) {
                                        var href = '@Url.Action("Edit","Product")/' + id;
                                        var button = "<button type='submit' class='btn btn-xs btn-danger' title='Delete'><span><i class='mdi mdi-18px mdi-delete'></i></span></button>"
                                        var action = '<a href="' + href +'" class="btn btn-xs btn-info" asp-action="Edit" asp-controller="Product" asp-route-id=id title="Edit"><span><i class="mdi mdi-18px mdi-pencil"></i></span></a>'

                                        var formtag = "<form method='post' asp-controller='Product' asp-action='Delete' asp-route-id='" + id + "'>" + action + button + "</form>"
                                        return formtag
                                    }

                                }


                                //{ 'data': 'Code' },
                                //{ 'data': 'Description' },
                                //{ 'data': 'Category' },
                                //{ 'data': 'BrandName' },
                                //{ 'data': 'ModelName' },
                                //{ 'data': 'Color' },
                                //{ 'data': 'SizeName' },
                                //{ 'data': 'SizeType' },
                                //{ 'data': 'Unitprice' },
                                //{ 'data': 'OpeningBalance' },

                            ]
                        })

                    }, error:function(err) {
                        alert(err.message)
                    }

                })*@
            }

            loadDataTable();


        })
    </script>



}